var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),KeyStore;!function(e){var t=function(){function e(){}return e.setDbType=function(){self.indexedDB=self.indexedDB||self.mozIndexedDB||self.webkitIndexedDB||self.msIndexedDB,indexedDB?(self.IDBTransaction=self.IDBTransaction||self.webkitIDBTransaction||self.msIDBTransaction,self.IDBKeyRange=self.IDBKeyRange||self.webkitIDBKeyRange||self.msIDBKeyRange):self.alert?JsStore.status={ConStatus:JsStore.Connection_Status.UnableToStart,LastError:JsStore.Error_Type.IndexedDbUndefined}:(console.log("worked failed"),self.postMessage("message:WorkerFailed"))},e}();e.Utils=t}(KeyStore||(KeyStore={}));var KeyStore;!function(e){(t=e.ConnectionStatus||(e.ConnectionStatus={})).Connected="connected",t.Closed="closed",t.NotStarted="not_connected";var t;e.request_queue=[],e.table_name="LocalStore",e.is_code_executing=!1}(KeyStore||(KeyStore={}));var KeyStore;!function(e){e.prcoessExecutionOfCode=function(t){e.request_queue.push(t),1===e.request_queue.length&&e.executeCode()},e.executeCode=function(){if(!e.is_code_executing&&e.request_queue.length>0){e.is_code_executing=!0;var t={Name:e.request_queue[0].Name,Query:e.request_queue[0].Query};e.executeCodeDirect(t)}},e.executeCodeDirect=function(t){new e.Business.Main(function(e){this.processFinishedRequest(e)}.bind(this)).checkConnectionAndExecuteLogic(t)},e.processFinishedRequest=function(t){var r=e.request_queue.shift();e.is_code_executing=!1,t.ErrorOccured?r.OnError?r.OnError(t.ErrorDetails):console.log(t.ErrorDetails):r.OnSuccess&&r.OnSuccess(t.ReturnedValue),this.executeCode()}}(KeyStore||(KeyStore={}));var KeyStore;!function(e){!function(e){var t=function(){return function(){this._results=null,this._errorOccured=!1,this._errorCount=0,this.on_errorOccured=function(e){++this._errorCount,1===this._errorCount&&null!=this.OnError&&this.OnError(e.target.error),console.error(e)}}}();e.Base=t}(e.Business||(e.Business={}))}(KeyStore||(KeyStore={}));var KeyStore;!function(e){!function(e){var t=function(t){__extends(r,t);function r(r,n,s){var i=t.call(this)||this;return i.get=function(){var e=function(e,t){var r=this._objectStore.index(e).openCursor(IDBKeyRange.only(t));r.onerror=function(e){this._errorOccured=!0,this.on_errorOccured(e)}.bind(this),r.onsuccess=function(e){var t=e.target.result;t&&(this._results=t.value.Value)}.bind(this)}.bind(this);for(var t in this._query.Where){e(t,this._query.Where[t]);break}},i._query=r,i._onError=s,i._transaction=e.db_connection.transaction([r.From],"readonly"),i._objectStore=i._transaction.objectStore(r.From),i._transaction.oncomplete=function(e){null!=n&&n(this._results)}.bind(i),i.get(),i}return r}(e.Base);e.Get=t}(e.Business||(e.Business={}))}(KeyStore||(KeyStore={}));var KeyStore;!function(e){!function(e){var t=function(t){__extends(r,t);function r(r,n,s){var i=t.call(this)||this;i.setData=function(e){var t=function(){var t=this._objectStore.index("Key").openCursor(IDBKeyRange.only(e.Key));t.onsuccess=function(t){var n=t.target.result;n?(n.value.Value=e.Value,n.update(n.value)):r()}.bind(this),t.onerror=function(e){this._errorOccured=!0,this.on_errorOccured(e)}.bind(this)}.bind(this),r=function(){this._objectStore.add(e).onerror=function(e){this._errorOccured=!0,this.on_errorOccured(e)}.bind(this)}.bind(this);t()};try{i._onError=s,i._transaction=e.db_connection.transaction([r.TableName],"readwrite"),i._objectStore=i._transaction.objectStore(r.TableName),i._transaction.oncomplete=function(e){null!=n&&n()},i.setData(r.Set)}catch(e){console.error(e)}return i}return r}(e.Base);e.Set=t}(e.Business||(e.Business={}))}(KeyStore||(KeyStore={}));var KeyStore;!function(e){!function(e){var t=function(t){__extends(r,t);function r(r,n,s){var i=t.call(this)||this;return i._rowAffected=0,i.remove=function(){var e=function(e,t){var r=this._objectStore.index(e).openCursor(IDBKeyRange.only(t));r.onerror=function(e){this._errorOccured=!0,this.on_errorOccured(e)}.bind(this),r.onsuccess=function(e){var t=e.target.result;t&&(t.delete(),++this._rowAffected,t.continue())}.bind(this)}.bind(this);for(var t in this._query.Where){this._errorOccured||e(t,this._query.Where[t]);break}},i._query=r,i._onError=s,i._transaction=e.db_connection.transaction([r.From],"readwrite"),i._objectStore=i._transaction.objectStore(r.From),i._transaction.oncomplete=function(){null!=n&&n(this._rowAffected)}.bind(i),i._transaction.onerror=function(e){this.on_errorOccured(e)}.bind(i),i.remove(),i}return r}(e.Base);e.Remove=t}(e.Business||(e.Business={}))}(KeyStore||(KeyStore={}));var KeyStore;!function(e){!function(t){var r=function(){return function(r,n,s,i){var o=self.indexedDB.open(r,1);o.onerror=function(e){"InvalidStateError"===e.target.error.name&&(JsStore.status={ConStatus:JsStore.Connection_Status.UnableToStart,LastError:JsStore.Error_Type.IndexedDbBlocked}),null!=i&&i(e.target.error)},o.onsuccess=function(r){t.status.ConStatus=e.ConnectionStatus.Connected,t.db_connection=o.result,t.db_connection.onclose=function(){t.status.ConStatus=e.ConnectionStatus.Closed,t.status.LastError="Connection Closed"},t.db_connection.onversionchange=function(e){null===e.newVersion&&e.target.close()},t.db_connection.onerror=function(e){t.status.LastError="Error occured in connection :"+e.target.result},t.db_connection.onabort=function(r){t.status.ConStatus=e.ConnectionStatus.Closed,t.status.LastError="Connection aborted"},null!=s&&s()},o.onupgradeneeded=function(e){e.target.result.createObjectStore(n,{keyPath:"Key"}).createIndex("Key","Key",{unique:!0})}}}();t.InitDb=r}(e.Business||(e.Business={}))}(KeyStore||(KeyStore={}));var KeyStore;!function(e){!function(t){t.status={ConStatus:e.ConnectionStatus.NotStarted,LastError:""};var r=function(){return function(r){void 0===r&&(r=null),this.set=function(e,r,n){new t.Set(e,r,n)},this.remove=function(e,r,n){new t.Remove(e,r,n)},this.get=function(e,r,n){new t.Get(e,r,n)},this.createDb=function(e,r,n){new t.InitDb("KeyStore",e,r,n)},this.checkConnectionAndExecuteLogic=function(r){"create_db"===r.Name||"open_db"===r.Name?this.executeLogic(r):t.status.ConStatus===e.ConnectionStatus.Connected?this.executeLogic(r):t.status.ConStatus===e.ConnectionStatus.NotStarted?setTimeout(function(){this.checkConnectionAndExecuteLogic(r)}.bind(this),100):t.status.ConStatus===e.ConnectionStatus.Closed&&this.createDb(e.table_name,function(){this.checkConnectionAndExecuteLogic(r)}.bind(this),100)},this.returnResult=function(e){this._onSuccess&&this._onSuccess(e)},this.executeLogic=function(e){var t=function(e){this.returnResult({ReturnedValue:e})}.bind(this),r=function(e){this.returnResult({ErrorDetails:e,ErrorOccured:!0})}.bind(this);switch(e.Name){case"get":this.get(e.Query,t,r);break;case"set":this.set(e.Query,t,r);break;case"remove":this.remove(e.Query,t,r);break;case"create_db":this.createDb(e.Query,t,r)}},this._onSuccess=r}}();t.Main=r}(e.Business||(e.Business={}))}(KeyStore||(KeyStore={}));var KeyStore;!function(e){e.init=function(){e.Utils.setDbType(),indexedDB&&e.prcoessExecutionOfCode({Name:"create_db",Query:e.table_name})},e.get=function(t,r,n){void 0===n&&(n=null);var s={From:e.table_name,Where:{Key:t}};return e.prcoessExecutionOfCode({Name:"get",Query:s,OnSuccess:r,OnError:n}),this},e.set=function(t,r,n,s){var i={TableName:e.table_name,Set:{Key:t,Value:r}};return e.prcoessExecutionOfCode({Name:"set",Query:i,OnSuccess:n,OnError:s}),this},e.remove=function(t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var s={From:e.table_name,Where:{Key:t}};return e.prcoessExecutionOfCode({Name:"remove",Query:s,OnSuccess:r,OnError:n}),this}}(KeyStore||(KeyStore={}));var JsStore;!function(e){(t=e.Occurence||(e.Occurence={})).First="f",t.Last="l",t.Any="a";var t;(r=e.WebWorker_Status||(e.WebWorker_Status={})).Registered="registerd",r.Failed="failed",r.NotStarted="not_started";var r;(n=e.Connection_Status||(e.Connection_Status={})).Connected="connected",n.Closed="closed",n.NotStarted="not_started",n.UnableToStart="unable_to_start";var n;(s=e.WhereQryOption||(e.WhereQryOption={})).In="In",s.Like="Like",s.Or="Or";var s;(i=e.Data_Type||(e.Data_Type={})).String="string",i.Object="object",i.Array="array",i.Number="number",i.Boolean="boolean",i.Null="null";var i}(JsStore||(JsStore={}));var JsStore;!function(e){e.enable_log=!1,e.db_version=0,e.status={ConStatus:e.Connection_Status.NotStarted,LastError:null},e.setFileName=function(t){e.file_name=t},e.getObjectFirstKey=function(e){for(var t in e)return t;return null},e.log=function(t){e.enable_log&&console.log(t)},e.logError=function(t){e.enable_log&&console.error(t)}}(JsStore||(JsStore={}));var JsStore;!function(e){var t=function(){function e(){}return e.convertObjectintoLowerCase=function(e){for(var t=Object.keys(e),r=t.length;r--;){var n=t[r];e[n.toLowerCase()]=e[n],delete e[n]}},e}();e.Utils=t}(JsStore||(JsStore={}));var JsStore;!function(e){e.isDbExist=function(t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var s=!r;if(e.status.ConStatus!==e.Connection_Status.UnableToStart){if(s)return new Promise(function(r,n){"string"==typeof t?e.getDbVersion(t,function(e){r(Boolean(e))}):e.getDbVersion(t.DbName,function(e){r(t.Table.Version<=e)})});"string"==typeof t?e.getDbVersion.call(this,t,function(e){r.call(this,Boolean(e))}):e.getDbVersion.call(this,t.DbName,function(e){r.call(this,t.Table.Version<=e)})}else{var i={_type:e.status.LastError,_message:null};switch(i._type){case e.Error_Type.IndexedDbBlocked:i._message="IndexedDB is blocked";break;case e.Error_Type.IndexedDbUndefined:i._message="IndexedDB is not supported"}if(s)return new Promise(function(e,t){t(i)});n&&n(i)}},e.getDbVersion=function(e,t){KeyStore.get("JsStore_"+e+"_Db_Version",function(e){t.call(this,Number(e))}.bind(this))},e.getDbSchema=function(t,r){r&&KeyStore.get("JsStore_"+t+"_Schema",function(n){if(n)if(n._name)r(n);else{var s=new e.Model.DataBase(n);KeyStore.set("JsStore_"+t+"_Schema",s),r(s)}else r(n)})},e.isNull=function(e){if(null==e)return!0;switch(typeof e){case"string":return 0===e.length;case"number":return isNaN(e)}return!1},e.enableLog=function(){e.enable_log=!0,e.worker_instance&&e.worker_instance.postMessage({Name:"change_log_status",Query:{logging:e.enable_log}})},e.disableLog=function(){e.enable_log=!1,e.worker_instance&&e.worker_instance.postMessage({Name:"change_log_status",Query:{logging:e.enable_log}})},e.getType=function(t){if(null===t)return e.Data_Type.Null;var r=typeof t;switch(r){case"object":if(Array.isArray(t))return e.Data_Type.Array;default:return r}}}(JsStore||(JsStore={}));var JsStore;!function(e){var t;(r=t=e.Error_Type||(e.Error_Type={})).UndefinedColumn="undefined_column",r.UndefinedValue="undefined_value",r.UndefinedColumnName="undefined_column_name",r.UndefinedDbName="undefined_database_name",r.UndefinedColumnValue="undefined_column_value",r.NotArray="not_array",r.NoValueSupplied="no_value_supplied",r.ColumnNotExist="column_not_exist",r.EnableSearchOff="enable_search_off",r.InvalidOp="invalid_operator",r.NullValue="null_value",r.BadDataType="bad_data_type",r.NextJoinNotExist="next_join_not_exist",r.TableNotExist="table_not_exist",r.DbNotExist="db_not_exist",r.IndexedDbUndefined="indexeddb_undefined",r.IndexedDbBlocked="indexeddb_blocked",r.ConnectionAborted="connection_aborted",r.ConnectionClosed="connection_closed",r.NotObject="not_object";var r,n=function(){function e(e,r){void 0===r&&(r=null),this.throw=function(){throw this.get()},this.logError=function(){console.error(this.get())},this.logWarning=function(){console.warn(this.get())},this.getMsg=function(){var e;switch(this._type){case t.NotArray:e="Supplied value is not an array";break;case t.UndefinedColumn:e="Column is undefined in Where";break;case t.UndefinedValue:e="Value is undefined in Where";break;case t.UndefinedColumnName:e="Column name is undefined '"+this._info.TableName+"'";break;case t.UndefinedDbName:e="Database name is not supplied";break;case t.UndefinedColumnValue:e="Column value is undefined";break;case t.NoValueSupplied:e="No value supplied";break;case t.InvalidOp:e="Invalid Op Value '"+this._info.Op+"'";break;case t.ColumnNotExist:e="Column '"+this._info.ColumnName+"' does not exist";break;case t.EnableSearchOff:e="Search is turned off for the Column '"+this._info.ColumnName+"'";break;case t.NullValue:e="Null value is not allowed for column '"+this._info.ColumnName+"'";break;case t.BadDataType:e="Supplied value for column '"+this._info.ColumnName+"' does not have valid type";break;case t.NextJoinNotExist:e="Next join details not supplied";break;case t.TableNotExist:e="Table '"+this._info.TableName+"' does not exist";break;case t.DbNotExist:e="Database '"+this._info.DbName+"' does not exist";break;case t.NotObject:e="supplied value is not object";break;default:e=this._message}return e},this._type=e,this._info=r,this._message=this.getMsg()}return e.prototype.get=function(){return{_message:this._message,_type:this._type}},e}();e.Error=n}(JsStore||(JsStore={}));var JsStore;!function(e){!function(t){var r=function(){return function(t,r){null!=t.Name?this._name=t.Name:new e.Error(e.Error_Type.UndefinedColumnName,{TableName:r}).throw();this._autoIncrement=null!=t.AutoIncrement&&t.AutoIncrement,this._primaryKey=null!=t.PrimaryKey&&t.PrimaryKey,this._unique=null!=t.Unique&&t.Unique,this._notNull=null!=t.NotNull&&t.NotNull,this._dataType=null!=t.DataType?t.DataType:t.AutoIncrement?"number":null,this._default=t.Default,this._multiEntry=null!=t.MultiEntry&&t.MultiEntry,this._enableSearch=null==t.EnableSearch||t.EnableSearch}}();t.Column=r}(e.Model||(e.Model={}))}(JsStore||(JsStore={}));var JsStore;!function(e){!function(e){var t=function(){return function(t){this._columns=[],this._name=t.Name,this._version=null==t.Version?1:t.Version,t.Columns.forEach(function(r){this._columns.push(new e.Column(r,t.Name))},this)}}();e.Table=t}(e.Model||(e.Model={}))}(JsStore||(JsStore={}));var JsStore;!function(e){!function(t){var r=function(){function t(e){this._columns=[],this._requireDelete=!1,this._requireCreation=!1,this.createMetaData=function(e,t){this._callback=t,this.setRequireDelete(e),this.setDbVersion(e)},this._name=e._name,this._version=e._version,this._columns=e._columns,this.setPrimaryKey()}return t.prototype.setPrimaryKey=function(){this._columns.every(function(e){return this._primaryKey=e._primaryKey?e._name:"",!e._primaryKey},this)},t.prototype.setRequireDelete=function(e){KeyStore.get("JsStore_"+e+"_"+this._name+"_Version",function(e){null==e?this._requireCreation=!0:e<this._version&&(this._requireDelete=!0)}.bind(this))},t.prototype.setDbVersion=function(t){e.db_version=e.db_version>this._version?e.db_version:this._version,KeyStore.set("JsStore_"+t+"_Db_Version",e.db_version).set("JsStore_"+t+"_"+this._name+"_Version",e.db_version,this._callback),this._version=e.db_version},t}();t.TableHelper=r}(e.Model||(e.Model={}))}(JsStore||(JsStore={}));var JsStore;!function(e){!function(e){var t=function(){return function(t){this._tables=[],this.createMetaData=function(t){var r=0,n=[],s=function(){if(r<this._tables.length){var i=this._tables[r],o=new e.TableHelper(i);o.createMetaData(this._name,function(){o._callback=null,n.push(o),s()}),++r}else t(n)}.bind(this);s()},this._name=t._name,this._tables=t._tables}}();e.DbHelper=t}(e.Model||(e.Model={}))}(JsStore||(JsStore={}));var JsStore;!function(e){!function(e){var t=function(){return function(t){this._tables=[],this._name=t.Name,t.Tables.forEach(function(t){this._tables.push(new e.Table(t))},this)}}();e.DataBase=t}(e.Model||(e.Model={}))}(JsStore||(JsStore={}));var JsStore;!function(e){!function(t){var r=function(){function r(){this.filterOnOccurence=function(t){var r=!1;switch(t=t.toLowerCase(),this._compSymbol){case e.Occurence.Any:t.indexOf(this._compValue)>=0&&(r=!0);break;case e.Occurence.First:0===t.indexOf(this._compValue)&&(r=!0);break;default:t.lastIndexOf(this._compValue)===t.length-this._compValueLength&&(r=!0)}return r},this.isTableExist=function(e){var r=!1;return t.active_db._tables.every(function(t){return t._name!==e||(r=!0,!1)}),r},this.getTable=function(e){var r;return t.active_db._tables.every(function(t){return t._name!==e||(r=t,!1)}),r},this.getKeyRange=function(e,t){var r;switch(t){case"-":r=IDBKeyRange.bound(e.Low,e.High,!1,!1);break;case">":r=IDBKeyRange.lowerBound(e,!0);break;case">=":r=IDBKeyRange.lowerBound(e);break;case"<":r=IDBKeyRange.upperBound(e,!0);break;case"<=":r=IDBKeyRange.upperBound(e);break;default:r=IDBKeyRange.only(e)}return r},this.getObjectSecondKey=function(e){var t=!1;for(var r in e){if(t)return r;t=!0}},this.getPrimaryKey=function(e){var t=this.getTable(e)._primaryKey;return t||this.getKeyPath(e)},this.getKeyPath=function(e){return t.db_connection.transaction([e],"readonly").objectStore(e).keyPath},this.sortNumberInAsc=function(e){return e.sort(function(e,t){return e-t}),e},this.sortNumberInDesc=function(e){return e.sort(function(e,t){return t-e}),e},this.sortAlphabetInAsc=function(e){return e.sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}),e},this.sortAlphabetInDesc=function(e){return e.sort(function(e,t){return t.toLowerCase().localeCompare(e.toLowerCase())}),e}}return r.prototype.getAllCombinationOfWord=function(e,t){if(t){for(var r=[],n=0,s=e.length;n<s;n++)r=r.concat(this.getCombination(e[n]));return r}return this.getCombination(e)},r.prototype.getCombination=function(e){var t=[],r=function(e,n,s){if(s===e.length)t.push(n.join(""));else{var i=e.charAt(s);n[s]=i.toLowerCase(),r(e,n,s+1),n[s]=i.toUpperCase(),r(e,n,s+1)}};return r(e,[],0),t},r}();t.BaseHelper=r}(e.Business||(e.Business={}))}(JsStore||(JsStore={}));var JsStore;!function(e){!function(t){var r=function(r){__extends(n,r);function n(){var n=null!==r&&r.apply(this,arguments)||this;return n._errorOccured=!1,n._errorCount=0,n._rowAffected=0,n.onErrorOccured=function(t,r){if(void 0===r&&(r=!1),++this._errorCount,1===this._errorCount&&null!=this._onError)if(r)this._onError(t),e.logError(t);else{var n={_message:t.target.error.message,_type:t.target.error.name};this._onError(n),e.logError(n)}},n.onExceptionOccured=function(t,r){switch(t.name){case"NotFoundError":var n=new e.Error(e.Error_Type.TableNotExist,r);this.onErrorOccured(n.get(),!0);break;default:console.error(t)}},n.goToWhereLogic=function(){this._whereChecker=new t.WhereChecker(this._query.Where);var r=e.getObjectFirstKey(this._query.Where);if(!0===this._query.IgnoreCase&&(this._query.Where=this.makeQryInCaseSensitive(this._query.Where)),this._objectStore.indexNames.contains(r)){var n=this._query.Where[r];if("object"==typeof n){this._checkFlag=Boolean(Object.keys(n).length>1||Object.keys(this._query.Where).length>1);var s=e.getObjectFirstKey(n);switch(s){case"Like":var i,o,u=n.Like.split("%");u[1]?(i=u[1],o=u.length>2?e.Occurence.Any:e.Occurence.Last):(i=u[0],o=e.Occurence.First),o===e.Occurence.First?(this.getAllCombinationOfWord(i).forEach(function(e){this.executeWhereLogic(r,{"-":{Low:e,High:e+"ï¿¿"}},"-")},this),delete this._query.Where[r].Like):this.executeLikeLogic(r,i,o);break;case"In":this.executeInLogic(r,n.In);break;case"-":case">":case"<":case">=":case"<=":this.executeWhereLogic(r,n,s);break;case"Aggregate":break;default:this.executeWhereLogic(r,n)}}else this._checkFlag=Boolean(Object.keys(this._query.Where).length>1),this.executeWhereLogic(r,n)}else{this._errorOccured=!0;var c;c=null==this.getColumnInfo(r)?new e.Error(e.Error_Type.ColumnNotExist,{ColumnName:r}).get():new e.Error(e.Error_Type.EnableSearchOff,{ColumnName:r}).get(),this.onErrorOccured(c,!0)}},n.makeQryInCaseSensitive=function(t){var r,n,s=[];for(var i in t)if("object"==typeof(r=t[i])){for(var o in r)switch(n=r[o],o){case e.WhereQryOption.In:s=s.concat(this.getAllCombinationOfWord(n,!0));break;case e.WhereQryOption.Like:break;default:s=s.concat(this.getAllCombinationOfWord(n))}t[i].In=s}else s=s.concat(this.getAllCombinationOfWord(r)),t[i]={In:s};return t},n}return n.prototype.getColumnInfo=function(e){return this.getTable(this._tableName)._columns.filter(function(t){return t._name===e})[0]},n}(t.BaseHelper);t.Base=r}(e.Business||(e.Business={}))}(JsStore||(JsStore={}));var JsStore;!function(e){!function(t){var r=function(){return function(r,n,s){var i=[],o=indexedDB.open(t.active_db._name,e.db_version);o.onerror=function(e){null!=s&&s(e.target.error)},o.onsuccess=function(r){e.status.ConStatus=e.Connection_Status.Connected,t.db_connection=o.result,t.db_connection.onclose=function(){e.status.ConStatus=e.Connection_Status.Closed,e.status.LastError=e.Error_Type.ConnectionClosed},t.db_connection.onversionchange=function(e){null===e.newVersion&&e.target.close()},t.db_connection.onerror=function(t){e.status.LastError="Error occured in connection :"+t.target.result},t.db_connection.onabort=function(t){e.status.ConStatus=e.Connection_Status.Closed,e.status.LastError=e.Error_Type.ConnectionAborted},null!=n&&n(i)},o.onupgradeneeded=function(e){t.db_connection=e.target.result,r.forEach(function(e,r){e._requireDelete?(t.db_connection.objectStoreNames.contains(e._name)&&t.db_connection.deleteObjectStore(e._name),u(e,r)):e._requireCreation&&u(e,r)})};var u=function(e,r){try{if(e._primaryKey.length>0){t.active_db._tables[r]._primaryKey=e._primaryKey;var n=t.db_connection.createObjectStore(e._name,{keyPath:e._primaryKey});e._columns.forEach(function(r){if(!0===r._enableSearch){var s=r._primaryKey?{unique:!0}:{unique:r._unique};s.multiEntry=r._multiEntry,n.createIndex(r._name,r._name,s),r._autoIncrement&&KeyStore.set("JsStore_"+t.active_db._name+"_"+e._name+"_"+r._name+"_Value",0)}})}else n=t.db_connection.createObjectStore(e._name,{autoIncrement:!0}),e._columns.forEach(function(r){var s={unique:r._unique,multiEntry:r._multiEntry};n.createIndex(r._name,r._name,s),r._autoIncrement&&KeyStore.set("JsStore_"+t.active_db._name+"_"+e._name+"_"+r._name+"_Value",0)});i.push(e._name),KeyStore.set("JsStore_"+t.active_db._name+"_"+e._name+"_Version",e._version)}catch(e){console.error(e)}}}}();t.CreateDb=r}(e.Business||(e.Business={}))}(JsStore||(JsStore={}));var JsStore;!function(e){!function(t){var r=function(){function r(e,t,r){setTimeout(function(){this.deleteDb(e,t,r)}.bind(this),100)}return r.prototype.deleteDb=function(r,n,s){var i=indexedDB.deleteDatabase(r);i.onblocked=function(){null!=s&&s("database is blocked, cant be deleted right now.")},i.onerror=function(e){null!=s&&s(event.target.error)},i.onsuccess=function(){e.status.ConStatus=e.Connection_Status.Closed,KeyStore.remove("JsStore_"+t.active_db._name+"_Db_Version"),t.active_db._tables.forEach(function(e){KeyStore.remove("JsStore_"+t.active_db._name+"_"+e._name+"_Version"),e._columns.forEach(function(r){r._autoIncrement&&KeyStore.remove("JsStore_"+t.active_db._name+"_"+e._name+"_"+r._name+"_Value")})}),KeyStore.remove("JsStore_"+t.active_db._name+"_Schema",n)}},r}();t.DropDb=r}(e.Business||(e.Business={}))}(JsStore||(JsStore={}));var JsStore;!function(e){!function(t){var r=function(r){__extends(n,r);function n(e,t,n){var s=r.call(this)||this;return s._query=e,s._onSuccess=t,s._onError=n,s}return n.prototype.execute=function(){if(Array.isArray(this._query.Values))if(!0===this.isTableExist(this._query.Into))try{this.bulkinsertData()}catch(e){this.onExceptionOccured(e,{TableName:this._query.Into})}else{new e.Error(e.Error_Type.TableNotExist,{TableName:this._query.Into}).throw()}else this.onErrorOccured(new e.Error(e.Error_Type.NotArray).get(),!0)},n.prototype.bulkinsertData=function(){t.createTransaction([this._query.Into],function(e){this._onSuccess()}.bind(this)),this._objectStore=t.db_transaction.objectStore(this._query.Into),this._query.Values.forEach(function(e){this._objectStore.add(e)},this)},n}(t.Base);t.BulkInsert=r}(e.Business||(e.Business={}))}(JsStore||(JsStore={}));var JsStore;!function(e){!function(t){var r=function(){return function(r,n,s){if(this.setPrimaryKey=function(){t.active_db._tables.forEach(function(e,r){e._columns.every(function(e){return t.active_db._tables[r]._primaryKey=e._primaryKey?e._name:"",!e._primaryKey})})},t.active_db._name.length>0){var i=indexedDB.open(t.active_db._name,r);i.onerror=function(e){null!=s&&s(e.target.error)},i.onsuccess=function(r){e.status.ConStatus=e.Connection_Status.Connected,t.db_connection=i.result,t.db_connection.onclose=function(){e.status.ConStatus=e.Connection_Status.Closed,e.status.LastError=e.Error_Type.ConnectionClosed},t.db_connection.onversionchange=function(e){null===e.newVersion&&e.target.close()},t.db_connection.onerror=function(t){e.status.LastError="Error occured in connection :"+t.target.result},t.db_connection.onabort=function(t){e.status.ConStatus=e.Connection_Status.Closed,e.status.LastError=e.Error_Type.ConnectionAborted},null!=n&&n(),this.setPrimaryKey()}.bind(this)}else new e.Error(e.Error_Type.UndefinedDbName).throw()}}();t.OpenDb=r}(e.Business||(e.Business={}))}(JsStore||(JsStore={}));var JsStore;!function(e){!function(e){var t=function(t){__extends(r,t);function r(r,n,s){var i=t.call(this)||this,o=e.db_connection.transaction([r],"readwrite").objectStore(r).clear();return o.onsuccess=function(t){this.getTable(r)._columns.forEach(function(t){t._autoIncrement&&KeyStore.set("JsStore_"+e.active_db._name+"_"+r+"_"+t._name+"_Value",0)}),null!=n&&n()}.bind(i),o.onerror=function(e){null!=s&&s(e)},i}return r}(e.Base);e.Clear=t}(e.Business||(e.Business={}))}(JsStore||(JsStore={}));var JsStore;!function(e){!function(t){t.db_transaction=null,t.createTransaction=function(e,r,n){null===t.db_transaction&&(n=n||"readwrite",t.db_transaction=t.db_connection.transaction(e,n),t.db_transaction.oncomplete=function(){t.db_transaction=null,r()},t.db_transaction.ontimeout=function(){t.db_transaction=null,console.error("transaction timed out")})};var r=function(){function r(e){void 0===e&&(e=null),this._onSuccess=e}return r.prototype.checkConnectionAndExecuteLogic=function(r){switch(e.log("checking connection and executing request:"+r.Name),r.Name){case"create_db":case"open_db":this.executeLogic(r);break;case"change_log_status":this.changeLogStatus(r);default:switch(e.status.ConStatus){case e.Connection_Status.Connected:this.executeLogic(r);break;case e.Connection_Status.Closed:this.openDb(t.active_db._name,function(){this.checkConnectionAndExecuteLogic(r)}.bind(this),r.OnError)}}},r.prototype.changeLogStatus=function(t){!0===t.Query.logging?e.enable_log=!0:e.enable_log=!1},r.prototype.returnResult=function(e){this._onSuccess?this._onSuccess(e):self.postMessage(e)},r.prototype.executeLogic=function(e){var t=function(e){this.returnResult({ReturnedValue:e})}.bind(this),r=function(e){this.returnResult({ErrorDetails:e,ErrorOccured:!0})}.bind(this);switch(e.Name){case"select":this.select(e.Query,t,r);break;case"insert":this.insert(e.Query,t,r);break;case"update":this.update(e.Query,t,r);break;case"remove":this.remove(e.Query,t,r);break;case"open_db":this.openDb(e.Query,t,r);break;case"create_db":this.createDb(e.Query,t,r);break;case"clear":this.clear(e.Query,t,r);break;case"drop_db":this.dropDb(t,r);break;case"count":this.count(e.Query,t,r);break;case"bulk_insert":this.bulkInsert(e.Query,t,r);break;case"transaction":this.transaction(e.Query,t,r);break;case"export_json":this.exportJson(e.Query,t,r);break;default:console.error("The Api:-"+e.Name+" does not support.")}},r.prototype.transaction=function(e,r,n){new t.Transaction(e,r,n).execute()},r.prototype.openDb=function(r,n,s){e.getDbVersion(r,function(i){if(0!==i)e.getDbSchema(r,function(e){t.active_db=e;new t.OpenDb(i,n,s)});else{var o=new e.Error(e.Error_Type.DbNotExist,{DbName:r});o.logError(),s(o.get())}})},r.prototype.closeDb=function(){e.status.ConStatus===e.Connection_Status.Connected&&t.db_connection.close()},r.prototype.dropDb=function(e,r){this.closeDb();new t.DropDb(t.active_db._name,e,r)},r.prototype.update=function(e,r,n){new t.Update.Instance(e,r,n).execute()},r.prototype.insert=function(e,r,n){new t.Insert.Instance(e,r,n).execute()},r.prototype.bulkInsert=function(e,r,n){new t.BulkInsert(e,r,n).execute()},r.prototype.remove=function(e,r,n){new t.Remove.Instance(e,r,n).execute()},r.prototype.select=function(e,r,n){if("object"==typeof e.From)new t.Select.Join(e,r,n);else{new t.Select.Instance(e,r,n).execute()}},r.prototype.count=function(e,r,n){if("object"==typeof e.From){e.Count=!0;new t.Select.Join(e,r,n)}else{new t.Count.Instance(e,r,n).execute()}},r.prototype.createDb=function(r,n,s){this.closeDb(),e.getDbVersion(r.Name,function(i){e.db_version=i||1,t.active_db=new e.Model.DataBase(r),KeyStore.set("JsStore_"+t.active_db._name+"_Schema",t.active_db);new e.Model.DbHelper(t.active_db).createMetaData(function(e){new t.CreateDb(e,n,s)})})},r.prototype.clear=function(e,r,n){new t.Clear(e,r,n)},r.prototype.exportJson=function(e,t,r){this.select(e,function(e){var r=URL.createObjectURL(new Blob([JSON.stringify(e)],{type:"text/json"}));t(r)},function(e){r(e)})},r}();t.Main=r}(e.Business||(e.Business={}))}(JsStore||(JsStore={}));var JsStore;!function(e){!function(t){var r=function(){return function(t){this.check=function(e){this._status=!0;var t;for(var r in this._where){if(!this._status)break;if("object"==typeof(t=this._where[r]))for(var n in t){if(!this._status)break;switch(n){case"In":this.checkIn(r,e[r]);break;case"Like":this.checkLike(r,e[r]);break;case"-":case">":case"<":case">=":case"<=":this.checkComparisionOp(r,e[r],n)}}else if(t!==e[r]){this._status=!1;break}}return this._status},this.checkIn=function(e,t){for(var r=0,n=this._where[e].In,s=n.length;r<s;r++){if(n[r]===t){this._status=!0;break}this._status=!1}},this.checkLike=function(t,r){var n,s,i,o=this._where[t].Like.split("%");switch(o[1]?(s=o[1],n=o.length>2?e.Occurence.Any:e.Occurence.Last):(s=o[0],n=e.Occurence.First),r=r.toLowerCase(),n){case e.Occurence.Any:(i=r.indexOf(s.toLowerCase()))<0&&(this._status=!1);break;case e.Occurence.First:((i=r.indexOf(s.toLowerCase()))>0||i<0)&&(this._status=!1);break;default:(i=r.lastIndexOf(s.toLowerCase()))<r.length-s.length&&(this._status=!1)}},this.checkComparisionOp=function(e,t,r){var n=this._where[e][r];switch(r){case">":t<=n&&(this._status=!1);break;case"<":t>=n&&(this._status=!1);break;case"<=":t>n&&(this._status=!1);break;case">=":t<n&&(this._status=!1);break;case"-":(t<n.Low||t>n.High)&&(this._status=!1)}},this._where=t}}();t.WhereChecker=r}(e.Business||(e.Business={}))}(JsStore||(JsStore={}));var JsStore;!function(JsStore){var Business;!function(Business){var Transaction=function(_super){__extends(Transaction,_super);function Transaction(e,t,r){var n=_super.call(this)||this;return e.AbortOnError=!e.AbortOnError||e.AbortOnError,n._query=e,n._onSuccess=t,n._onError=r,n}return Transaction.prototype.execute=function(){var request_queue=[],onRequestFinished=function(e){var t=request_queue.shift();t&&(this._errorOccured&&!0===this._query.AbortOnError?Business.db_transaction.abort():(t.OnSuccess&&t.OnSuccess(e),request_queue.length>=1&&executeRequest(request_queue[0])))}.bind(this),executeRequest=function(e){var t;switch(e.Name){case"select":t=new Business.Select.Instance(e.Query,onRequestFinished,this._onError.bind(this));break;case"insert":t=new Business.Insert.Instance(e.Query,onRequestFinished,this._onError.bind(this))}t._isTransaction=!0,t.execute()}.bind(this),pushRequest=function(e){request_queue.push(e),1===request_queue.length&&(this.initTransaction(this._query.TableNames),executeRequest(request_queue[0]))}.bind(this),select=function(e,t){t=e.OnSuccess?e.OnSuccess:t,pushRequest({Name:"select",OnSuccess:t,Query:e})},insert=function(e,t){t=e.OnSuccess?e.OnSuccess:t,pushRequest({Name:"insert",OnSuccess:t,Query:e})},update=function(e,t){t=e.OnSuccess?e.OnSuccess:t,pushRequest({Name:"update",OnSuccess:t,Query:e})},remove=function(e,t){t=e.OnSuccess?e.OnSuccess:t,pushRequest({Name:"remove",OnSuccess:t,Query:e})},count=function(e,t){t=e.OnSuccess?e.OnSuccess:t,pushRequest({Name:"count",OnSuccess:t,Query:e})};eval("var tx_logic ="+this._query.Logic),tx_logic.call(this,this._query.Data),this._query.Data=this._query.Logic=null},Transaction.prototype.initTransaction=function(e){Business.createTransaction(e,this.onTransactionCompleted.bind(this))},Transaction.prototype.onTransactionCompleted=function(){this._onSuccess(this._results)},Transaction}(Business.Base);Business.Transaction=Transaction}(Business=JsStore.Business||(JsStore.Business={}))}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var r=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._results=[],t._sorted=!1,t._checkFlag=!1,t}return t.prototype.removeDuplicates=function(){var e=this._results;this._results=void 0;var t=this.getPrimaryKey(this._query.From),r={};for(var n in e)r[e[n][t]]=e[n];e=[];for(n in r)e.push(r[n]);this._results=e},t}(t.Base);e.BaseSelect=r})((t=e.Business||(e.Business={})).Select||(t.Select={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(t){var r=function(t){__extends(r,t);function r(){var r=null!==t&&t.apply(this,arguments)||this;return r.executeWhereUndefinedLogic=function(){if(this._query.Order&&this._query.Order.By)if(this._objectStore.indexNames.contains(this._query.Order.By)){var t=this._query.Order.Type&&"desc"===this._query.Order.Type.toLowerCase()?"prev":"next";this._sorted=!0,this._cursorOpenRequest=this._objectStore.index(this._query.Order.By).openCursor(null,t)}else new e.Error(e.Error_Type.ColumnNotExist,{ColumnName:this._query.Order.By}).throw();else this._cursorOpenRequest=this._objectStore.openCursor();this._skipRecord&&this._limitRecord?this.executeSkipAndLimitForNoWhere():this._skipRecord?this.executeSkipForNoWhere():this._limitRecord?this.executeLimitForNotWhere():this.executeSimpleForNotWhere(),this._cursorOpenRequest.onerror=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this)},r.executeSkipAndLimitForNoWhere=function(){var e,t=!1;this._cursorOpenRequest.onsuccess=function(r){(e=r.target.result)?t&&this._results.length!==this._limitRecord?(this._results.push(e.value),e.continue()):(t=!0,e.advance(this._skipRecord)):this.onQueryFinished()}.bind(this)},r.executeSkipForNoWhere=function(){var e,t=!1;this._cursorOpenRequest.onsuccess=function(r){(e=r.target.result)?t?(this._results.push(e.value),e.continue()):(t=!0,e.advance(this._skipRecord)):this.onQueryFinished()}.bind(this)},r.executeSimpleForNotWhere=function(){var e;this._cursorOpenRequest.onsuccess=function(t){(e=t.target.result)?(this._results.push(e.value),e.continue()):this.onQueryFinished()}.bind(this)},r.executeLimitForNotWhere=function(){var e;this._cursorOpenRequest.onsuccess=function(t){(e=t.target.result)&&this._results.length!==this._limitRecord?(this._results.push(e.value),e.continue()):this.onQueryFinished()}.bind(this)},r}return r}(t.BaseSelect);t.NotWhere=r})((t=e.Business||(e.Business={})).Select||(t.Select={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.executeInLogic=function(e,t){this._skipRecord&&this._limitRecord?this.executeSkipAndLimitForIn(e,t):this._skipRecord?this.executeSkipForIn(e,t):this._limitRecord?this.executeLimitForIn(e,t):this.executeSimpleForIn(e,t)},t.executeSkipAndLimitForIn=function(e,t){var r,n,s=this._skipRecord,i=this._objectStore.index(e),o=function(e){0===s?this._results.push(e):--s}.bind(this),u=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this);if(this._checkFlag)for(var c=0,a=t.length;c<a;c++)this._errorOccured||((n=i.openCursor(IDBKeyRange.only(t[c]))).onsuccess=function(e){r=e.target.result,this._results.length!==this._limitRecord&&r?(this._whereChecker.check(r.value)&&o(r.value),r.continue()):c+1===a&&this.onQueryFinished()}.bind(this),n.onerror=u);else for(c=0,a=t.length;c<a;c++)this._errorOccured||((n=i.openCursor(IDBKeyRange.only(t[c]))).onsuccess=function(e){r=e.target.result,this._results.length!==this._limitRecord&&r?(o(r.value),r.continue()):c+1===a&&this.onQueryFinished()}.bind(this),n.onerror=u)},t.executeSkipForIn=function(e,t){var r,n,s=this._skipRecord,i=this._objectStore.index(e),o=function(e){0===s?this._results.push(e):--s}.bind(this),u=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this);if(this._checkFlag)for(var c=0,a=t.length;c<a;c++)this._errorOccured||((n=i.openCursor(IDBKeyRange.only(t[c]))).onsuccess=function(e){(r=e.target.result)?(this._whereChecker.check(r.value)&&o(r.value),r.continue()):c+1===a&&this.onQueryFinished()}.bind(this),n.onerror=u);else for(c=0,a=t.length;c<a;c++)this._errorOccured||((n=i.openCursor(IDBKeyRange.only(t[c]))).onsuccess=function(e){(r=e.target.result)?(o(r.value),r.continue()):c+1===a&&this.onQueryFinished()}.bind(this),n.onerror=u)},t.executeLimitForIn=function(e,t){var r,n,s=this._objectStore.index(e),i=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this);if(this._checkFlag)for(var o=0,u=t.length;o<u;o++)this._errorOccured||((n=s.openCursor(IDBKeyRange.only(t[o]))).onsuccess=function(e){(r=e.target.result)&&this._results.length!==this._limitRecord?(this._whereChecker.check(r.value)&&this._results.push(r.value),r.continue()):o+1===u&&this.onQueryFinished()}.bind(this),n.onerror=i);else for(o=0,u=t.length;o<u;o++)this._errorOccured||((n=s.openCursor(IDBKeyRange.only(t[o]))).onsuccess=function(e){(r=e.target.result)&&this._results.length!==this._limitRecord?(this._results.push(r.value),r.continue()):o+1===u&&this.onQueryFinished()}.bind(this),n.onerror=i)},t.executeSimpleForIn=function(e,t){var r,n,s=this._objectStore.index(e),i=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this);if(this._checkFlag)for(var o=0,u=t.length;o<u;o++)this._errorOccured||((n=s.openCursor(IDBKeyRange.only(t[o]))).onsuccess=function(e){(r=e.target.result)?(this._whereChecker.check(r.value)&&this._results.push(r.value),r.continue()):o+1===u&&this.onQueryFinished()}.bind(this),n.onerror=i);else for(o=0,u=t.length;o<u;o++)this._errorOccured||((n=s.openCursor(IDBKeyRange.only(t[o]))).onsuccess=function(e){(r=e.target.result)?(this._results.push(r.value),r.continue()):o+1===u&&this.onQueryFinished()}.bind(this),n.onerror=i)},t}return t}(e.NotWhere);e.In=t})((t=e.Business||(e.Business={})).Select||(t.Select={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.executeLikeLogic=function(e,t,r){this._compValue=t.toLowerCase(),this._compValueLength=this._compValue.length,this._compSymbol=r,this._cursorOpenRequest=this._objectStore.index(e).openCursor(),this._cursorOpenRequest.onerror=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this),this._skipRecord&&this._limitRecord?this.executeSkipAndLimit():this._skipRecord?this.executeSkip():this._limitRecord?this.executeLimit():this.executeSimple()},t.executeSkipAndLimit=function(){var e,t=this._skipRecord,r=function(e){0===t?this._results.push(e):--t}.bind(this);this._checkFlag?this._cursorOpenRequest.onsuccess=function(t){e=t.target.result,this._results.length!==this._limitRecord&&e?(this.filterOnOccurence(e.key)&&this._whereChecker.check(e.value)&&r(e.value),e.continue()):this.onQueryFinished()}.bind(this):this._cursorOpenRequest.onsuccess=function(t){e=t.target.result,this._results.length!==this._limitRecord&&e?(this.filterOnOccurence(e.key)&&r(e.value),e.continue()):this.onQueryFinished()}.bind(this)},t.executeSkip=function(){var e,t=this._skipRecord,r=function(e){0===t?this._results.push(e):--t}.bind(this);this._checkFlag?this._cursorOpenRequest.onsuccess=function(t){(e=t.target.result)?(this.filterOnOccurence(e.key)&&this._whereChecker.check(e.value)&&r(e.value),e.continue()):this.onQueryFinished()}.bind(this):this._cursorOpenRequest.onsuccess=function(t){(e=t.target.result)?(this.filterOnOccurence(e.key)&&r(e.value),e.continue()):this.onQueryFinished()}.bind(this)},t.executeLimit=function(){var e;this._checkFlag?this._cursorOpenRequest.onsuccess=function(t){e=t.target.result,this._results.length!==this._limitRecord&&e?(this.filterOnOccurence(e.key)&&this._whereChecker.check(e.value)&&this._results.push(e.value),e.continue()):this.onQueryFinished()}.bind(this):this._cursorOpenRequest.onsuccess=function(t){e=t.target.result,this._results.length!==this._limitRecord&&e?(this.filterOnOccurence(e.key)&&this._results.push(e.value),e.continue()):this.onQueryFinished()}.bind(this)},t.executeSimple=function(){var e;this._checkFlag?this._cursorOpenRequest.onsuccess=function(t){(e=t.target.result)?(this.filterOnOccurence(e.key)&&this._whereChecker.check(e.value)&&this._results.push(e.value),e.continue()):this.onQueryFinished()}.bind(this):this._cursorOpenRequest.onsuccess=function(t){(e=t.target.result)?(this.filterOnOccurence(e.key)&&this._results.push(e.value),e.continue()):this.onQueryFinished()}.bind(this)},t}return t}(e.In);e.Like=t})((t=e.Business||(e.Business={})).Select||(t.Select={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.executeSkipAndLimitForWhere=function(){var e,t=!1;this._checkFlag?this._cursorOpenRequest.onsuccess=function(r){(e=r.target.result)?t&&this._results.length!==this._limitRecord?(this._whereChecker.check(e.value)&&this._results.push(e.value),e.continue()):(t=!0,e.advance(this._skipRecord)):this.onQueryFinished()}.bind(this):this._cursorOpenRequest.onsuccess=function(r){(e=r.target.result)?t&&this._results.length!==this._limitRecord?(this._results.push(e.value),e.continue()):(t=!0,e.advance(this._skipRecord)):this.onQueryFinished()}.bind(this)},t.executeSkipForWhere=function(){var e,t=!1;this._checkFlag?this._cursorOpenRequest.onsuccess=function(r){(e=r.target.result)?t?(this._whereChecker.check(e.value)&&this._results.push(e.value),e.continue()):(t=!0,e.advance(this._skipRecord)):this.onQueryFinished()}.bind(this):this._cursorOpenRequest.onsuccess=function(r){(e=r.target.result)?t?(this._results.push(e.value),e.continue()):(t=!0,e.advance(this._skipRecord)):this.onQueryFinished()}.bind(this)},t.executeLimitForWhere=function(){var e;this._checkFlag?this._cursorOpenRequest.onsuccess=function(t){(e=t.target.result)&&this._results.length!==this._limitRecord&&this._whereChecker.check(e.value)?(this._results.push(e.value),e.continue()):this.onQueryFinished()}.bind(this):this._cursorOpenRequest.onsuccess=function(t){(e=t.target.result)&&this._results.length!==this._limitRecord?(this._results.push(e.value),e.continue()):this.onQueryFinished()}.bind(this)},t.executeSimpleForWhere=function(){var e;this._checkFlag?this._cursorOpenRequest.onsuccess=function(t){(e=t.target.result)?(this._whereChecker.check(e.value)&&this._results.push(e.value),e.continue()):this.onQueryFinished()}.bind(this):this._cursorOpenRequest.onsuccess=function(t){(e=t.target.result)?(this._results.push(e.value),e.continue()):this.onQueryFinished()}.bind(this)},t.executeWhereLogic=function(e,t,r,n){t=r?t[r]:t,this._cursorOpenRequest=this._objectStore.index(e).openCursor(this.getKeyRange(t,r),n),this._cursorOpenRequest.onerror=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this),this._skipRecord&&this._limitRecord?this.executeSkipAndLimitForWhere():this._skipRecord?this.executeSkipForWhere():this._limitRecord?this.executeLimitForWhere():this.executeSimpleForWhere()},t}return t}(e.Like);e.Where=t})((t=e.Business||(e.Business={})).Select||(t.Select={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(t){__extends(r,t);function r(r,n,s){var i=t.call(this)||this;i._queryStack=[],i._currentQueryStackIndex=0,i.onTransactionCompleted=function(e){null!=this._onSuccess&&this._queryStack.length===this._currentQueryStackIndex+1&&(this._query.Count?this._onSuccess(this._results.length):(this._query.Skip&&this._query.Limit?(this._results.splice(0,this._query.Skip),this._results.splice(this._query.Limit-1,this._results.length)):this._query.Skip?this._results.splice(0,this._query.Skip):this._query.Limit&&this._results.splice(this._query.Limit-1,this._results.length),this._onSuccess(this._results)))},i.executeWhereJoinLogic=function(t,r){var n,s=[],i=0,o=(r.Column,this._results),u=o.length;new e.Instance({From:r.Table,Where:r.Where,Order:r.Order},function(e){e.forEach(function(e,r){for(var s=0;s<u;s++)n=o[s][t.Table][t.Column],c(n,e,s)}),this._results=s,this._queryStack.length>this._currentQueryStackIndex+1?this.startExecutionJoinLogic():this.onTransactionCompleted(null)}.bind(this),this.onErrorOccured.bind(this)).execute();var c=function(e,t,n){if(s[i]={},e===t[r.Column]){s[i][r.Table]=t;for(var u=0;u<this._currentQueryStackIndex;u++)s[i][this._queryStack[u].Table]=o[n][this._queryStack[u].Table];++i}else if("left"===r.JoinType){for(s[i]={},s[i][r.Table]=null,u=0;u<this._currentQueryStackIndex;u++)s[i][this._queryStack[u].Table]=o[n][this._queryStack[u].Table];++i}}.bind(this)},i.executeRightJoin=function(t,r){var n=[],s=(r.Column,this._results),i=s.length,o=0,u=function(){this._results=n,this._queryStack.length>this._currentQueryStackIndex+1?this.startExecutionJoinLogic():this.onTransactionCompleted(null)}.bind(this),c=function(e){var u=!1;e.forEach(function(e,c){for(o=0;o<i;o++)if(e[r.Column]===s[o][t.Table][t.Column]){u=!0;break}if(n[c]={},n[c][r.Table]=e,u){u=!1;for(var a=0;a<this._currentQueryStackIndex;a++)n[c][this._queryStack[a].Table]=s[o][this._queryStack[a].Table]}else for(a=0;a<this._currentQueryStackIndex;a++)n[c][this._queryStack[a].Table]=null},this)}.bind(this);(function(){new e.Instance({From:r.Table,Where:r.Where,Order:r.Order},function(e){c(e),u()}.bind(this),this.onErrorOccured.bind(this)).execute()}).bind(this)()},i.executeWhereUndefinedLogicForJoin=function(t,r){var n=[],s=0,i=(r.Column,this._results),o=i.length,u=0,c={},a=function(){this._results=n,this._queryStack.length>this._currentQueryStackIndex+1?this.startExecutionJoinLogic():this.onTransactionCompleted(null)}.bind(this),h=function(e){if(e.length>0)e.forEach(function(e){n[s]={},n[s][r.Table]=e;for(var t=0;t<this._currentQueryStackIndex;t++)n[s][this._queryStack[t].Table]=i[u][this._queryStack[t].Table];++s},this);else if("left"===r.JoinType){n[s]={},n[s][r.Table]=null;for(var t=0;t<this._currentQueryStackIndex;t++)n[s][this._queryStack[t].Table]=i[u][this._queryStack[t].Table];++s}}.bind(this),l=function(){u<o?this._errorOccured||(c[r.Column]=i[u][t.Table][t.Column],new e.Instance({From:r.Table,Where:c,Order:r.Order},function(e){h(e),++u,l()}.bind(this),this.onErrorOccured.bind(this)).execute()):a()}.bind(this);l()},i._onSuccess=n,i._onError=s,i._query=r;var o=[],u=function(e){return e.hasOwnProperty("Table1")?(e.Table2.JoinType=void 0===e.Join?"inner":e.Join.toLowerCase(),this._queryStack.push(e.Table2),this._queryStack.length%2==0&&(this._queryStack[this._queryStack.length-1].NextJoin=e.NextJoin),o.push(e.Table2.Table),u(e.Table1)):(this._queryStack.push(e),void o.push(e.Table))}.bind(i);return u(r.From),i._queryStack.reverse(),i._errorOccured||new e.Instance({From:i._queryStack[0].Table,Where:i._queryStack[0].Where},function(e){var t=this._queryStack[0].Table;e.forEach(function(e,r){this._results[r]={},this._results[r][t]=e},this),this.startExecutionJoinLogic()}.bind(i),i.onErrorOccured.bind(i)).execute(),i}return r.prototype.startExecutionJoinLogic=function(){var e;this._currentQueryStackIndex>=1&&this._currentQueryStackIndex%2==1?(e={Table:this._queryStack[this._currentQueryStackIndex].NextJoin.Table,Column:this._queryStack[this._currentQueryStackIndex].NextJoin.Column},this._currentQueryStackIndex++):e=this._queryStack[this._currentQueryStackIndex++];var t=this._queryStack[this._currentQueryStackIndex];"right"===t.JoinType?this.executeRightJoin(e,t):t.Where?this.executeWhereJoinLogic(e,t):this.executeWhereUndefinedLogicForJoin(e,t)},r}(e.BaseSelect);e.Join=t})((t=e.Business||(e.Business={})).Select||(t.Select={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(e){__extends(t,e);function t(){return e.call(this)||this}return t.prototype.processGroupBy=function(){var e=this._query.GroupBy,t=this._results,r={};if(this._results=this._query.GroupBy=void 0,"string"==typeof e)for(var n in t)r[t[n][e]]=t[n];else{var s;for(var n in t){s="";for(var i in e)s+=t[n][e[i]];r[s]=t[n]}}t=[];for(n in r)t.push(r[n]);this._results=t},t.prototype.executeAggregateGroupBy=function(){var e=this._query.GroupBy,t=this._results,r={},n=this._query.Aggregate;this._query.Aggregate=void 0,this._results=void 0;var s,i,o,u,c=function(){for(var e in n)switch(e){case"Count":var c=function(){return o=(o=r[i])?o["Count("+u+")"]:0,o+=t[s][u]?1:0};if("string"==typeof n[e])u=n[e],t[s]["Count("+u+")"]=c();else if(Array.isArray(n[e]))for(var a in n[e])u=n[e][a],t[s]["Count("+u+")"]=c();break;case"Max":var h=function(){return o=(o=r[i])?o["Max("+u+")"]:0,t[s][u]=t[s][u]?t[s][u]:0,o>t[s][u]?o:t[s][u]};if("string"==typeof n[e])u=n[e],t[s]["Max("+u+")"]=h();else if(Array.isArray(n[e]))for(var a in n[e])u=n[e][a],t[s]["Max("+u+")"]=h();break;case"Min":var l=function(){return o=(o=r[i])?o["Min("+u+")"]:1/0,t[s][u]=t[s][u]?t[s][u]:1/0,o<t[s][u]?o:t[s][u]};if("string"==typeof n[e])u=n[e],t[s]["Min("+u+")"]=l();else if(Array.isArray(n[e]))for(var a in n[e])u=n[e][a],t[s]["Min("+u+")"]=l();break;case"Sum":var _=function(){return o=(o=r[i])?o["Sum("+u+")"]:0,o+=t[s][u]?t[s][u]:0};if("string"==typeof n[e])u=n[e],t[s]["Sum("+u+")"]=_();else if(Array.isArray(n[e]))for(var a in n[e])u=n[e][a],t[s]["Sum("+u+")"]=_();break;case"Avg":var d=function(){var e=(o=r[i])?o["Sum("+u+")"]:0;e+=t[s][u]?t[s][u]:0,t[s]["Sum("+u+")"]=e,o=o?o["Count("+u+")"]:0,o+=t[s][u]?1:0,t[s]["Count("+u+")"]=o};if("string"==typeof n[e])u=n[e],d();else if(Array.isArray(n[e]))for(var a in n[e])u=n[e][a],d()}};if("string"==typeof e)for(s in t)i=t[s][e],c(),r[i]=t[s];else for(s in t){i="";for(var a in e)i+=t[s][e[a]];c(),r[i]=t[s]}t=[];for(var h in r)t.push(r[h]);if(n.Avg)if("string"==typeof n.Avg)for(s in t){var l=t[s]["Sum("+n.Avg+")"],_=t[s]["Count("+n.Avg+")"];t[s]["Avg("+n.Avg+")"]=l/_,n.Count!==n.Avg&&delete t[s]["Count("+n.Avg+")"],n.Sum!==n.Avg&&delete t[s]["Sum("+n.Avg+")"]}else{var d=typeof n.Count,f=typeof n.Count;for(s in t)for(var a in n.Avg){var y=n.Avg[a],p=t[s]["Sum("+y+")"],b=t[s]["Count("+y+")"];t[s]["Avg("+y+")"]=p/b,d&&(n.Count!==y?delete t[s]["Count("+y+")"]:-1===n.Count.indexOf(y)&&delete t[s]["Count("+y+")"]),f&&(n.Sum!==y?delete t[s]["Sum("+y+")"]:-1===n.Sum.indexOf(y)&&delete t[s]["Sum("+y+")"])}}this._results=t},t}(e.Where);e.GroupByHelper=t})((t=e.Business||(e.Business={})).Select||(t.Select={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(e){__extends(t,e);function t(){return e.call(this)||this}return t.prototype.processOrderBy=function(){var e=this._query.Order;if(e&&this._results.length>0&&!this._sorted&&e.By){e.Type=e.Type?e.Type.toLowerCase():"asc";var t=e.By,r=function(){this._results.sort(function(e,r){return e[t]-r[t]})}.bind(this),n=function(){this._results.sort(function(e,r){return r[t]-e[t]})}.bind(this),s=function(){this._results.sort(function(e,r){return e[t].toLowerCase().localeCompare(r[t].toLowerCase())})}.bind(this),i=function(){this._results.sort(function(e,r){return r[t].toLowerCase().localeCompare(e[t].toLowerCase())})}.bind(this);"string"==typeof this._results[0][t]?"asc"===e.Type?s():i():"number"==typeof this._results[0][t]&&("asc"===e.Type?r():n())}},t.prototype.processAggregateQry=function(){var e,t=this._results,r={};this._results=void 0;for(var n in this._query.Aggregate)switch(n){case"Count":var s=function(){var r=0;for(var n in t)r+=t[n][e]?1:0;return r};if("string"==typeof this._query.Aggregate[n])r["Count("+(e=this._query.Aggregate[n])+")"]=s();else if(Array.isArray(this._query.Aggregate[n]))for(var i in this._query.Aggregate[n])r["Count("+(e=this._query.Aggregate[n][i])+")"]=s();break;case"Max":var o=function(){var r=0;for(var n in t)r=r>t[n][e]?r:t[n][e];return r};if("string"==typeof this._query.Aggregate[n])r["Max("+(e=this._query.Aggregate[n])+")"]=o();else if(Array.isArray(this._query.Aggregate[n]))for(var i in this._query.Aggregate[n])r["Max("+(e=this._query.Aggregate[n][i])+")"]=o();break;case"Min":var u=function(){var r=1/0,n=1/0;for(var s in t)r=r<(n=t[s][e]?t[s][e]:1/0)?r:n;return r};if("string"==typeof this._query.Aggregate[n])r["Min("+(e=this._query.Aggregate[n])+")"]=u();else if(Array.isArray(this._query.Aggregate[n]))for(var i in this._query.Aggregate[n])r["Min("+(e=this._query.Aggregate[n][i])+")"]=u();break;case"Sum":var c=function(){var r=0;for(var n in t)r+=t[n][e];return r};if("string"==typeof this._query.Aggregate[n])r["Sum("+(e=this._query.Aggregate[n])+")"]=c();else if(Array.isArray(this._query.Aggregate[n]))for(var i in this._query.Aggregate[n])r["Sum("+(e=this._query.Aggregate[n][i])+")"]=c();break;case"Avg":var a=function(){var r=0;for(var n in t)r+=t[n][e];return r/t.length};if("string"==typeof this._query.Aggregate[n])r["Avg("+(e=this._query.Aggregate[n])+")"]=a();else if(Array.isArray(this._query.Aggregate[n]))for(var i in this._query.Aggregate[n])r["Avg("+(e=this._query.Aggregate[n][i])+")"]=a()}for(var n in r)t[0][n]=r[n];this._results=t},t}(e.GroupByHelper);e.Helper=t})((t=e.Business||(e.Business={})).Select||(t.Select={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(r){var n=function(r){__extends(n,r);function n(e,t,n){var s=r.call(this)||this;return s._onError=n,s._onSuccess=t,s._query=e,s._skipRecord=s._query.Skip,s._limitRecord=s._query.Limit,s._tableName=s._query.From,s}return n.prototype.execute=function(){if(!0===this.isTableExist(this._tableName))try{this.initTransaction(),this._query.Where?Array.isArray(this._query.Where)?this.processWhereArrayQry():this.processWhere():this.executeWhereUndefinedLogic()}catch(e){this._errorOccured=!0,this.onExceptionOccured.call(this,e,{TableName:this._query.From})}else this._errorOccured=!0,this.onErrorOccured(new e.Error(e.Error_Type.TableNotExist,{TableName:this._query.From}).get(),!0)},n.prototype.processWhereArrayQry=function(){this._isArrayQry=!0;var e,t=!0,r=this._query.Where,n=[],s=this.getPrimaryKey(this._query.From),i=function(){if("and"===e){var i=function(){var e=[];this._results.forEach(function(t){(function(e){var t=!1;return n.every(function(r){return r[s]!==e||(t=!0,!1)}),t})(t[s])&&e.push(t)}),n=e,e=null}.bind(this);n.length>0?i():!0===t?n=this._results:i()}else n.length>0?(this._results=n.concat(this._results),this.removeDuplicates(),n=this._results):n=this._results;r.length>0?(this._results=[],o()):this._results=n,t=!1}.bind(this),o=function(){this._query.Where=r.shift(),this._query.Where.Or&&1===Object.keys(this._query.Where).length?(e="or",this._query.Where=this._query.Where.Or,this._onWhereArrayQrySuccess=i):(e="and",this._onWhereArrayQrySuccess=i),this.processWhere()}.bind(this);o()},n.prototype.onQueryFinished=function(){!0===this._isOr?this.orQuerySuccess():!0===this._isArrayQry?this._onWhereArrayQrySuccess():!0===this._isTransaction&&this.onTransactionCompleted()},n.prototype.initTransaction=function(){t.createTransaction([this._query.From],this.onTransactionCompleted.bind(this),"readonly"),this._objectStore=t.db_transaction.objectStore(this._query.From)},n.prototype.processWhere=function(){this._query.Where.Or&&this.processOrLogic(),this.goToWhereLogic()},n.prototype.onTransactionCompleted=function(){if(!1===this._errorOccured){if(this.processOrderBy(),this._query.Distinct){var e=[],t=this._results[0];for(var r in t)e.push(r);var n=this.getPrimaryKey(this._query.From),s=e.indexOf(n);e.splice(s,1),this._query.GroupBy=e.length>0?e:null}this._query.GroupBy?this._query.Aggregate?this.executeAggregateGroupBy():this.processGroupBy():this._query.Aggregate&&this.processAggregateQry(),this._onSuccess(this._results)}},n.prototype.orQueryFinish=function(){this._isOr=!1,this._results=this._orInfo.Results,this._orInfo=void 0,this.removeDuplicates(),this.onQueryFinished()},n.prototype.orQuerySuccess=function(){if(this._orInfo.Results=this._orInfo.Results.concat(this._results),!this._query.Limit||this._query.Limit>this._orInfo.Results.length){this._results=[];var t=e.getObjectFirstKey(this._orInfo.OrQuery);if(null!=t){var r={};r[t]=this._orInfo.OrQuery[t],delete this._orInfo.OrQuery[t],this._query.Where=r,this.goToWhereLogic()}else this.orQueryFinish()}else this.orQueryFinish()},n.prototype.processOrLogic=function(){this._isOr=!0,this._orInfo={OrQuery:this._query.Where.Or,Results:[]},delete this._query.Where.Or},n}(r.Helper);r.Instance=n})((t=e.Business||(e.Business={})).Select||(t.Select={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var r=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._resultCount=0,t._checkFlag=!1,t}return t}(t.Base);e.BaseCount=r})((t=e.Business||(e.Business={})).Count||(t.Count={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.executeWhereUndefinedLogic=function(){if(this._objectStore.count){var e=this._objectStore.count();e.onsuccess=function(){this._resultCount=e.result,this.onQueryFinished()}.bind(this),e.onerror=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this)}else{var t,r=this._objectStore.openCursor();r.onsuccess=function(e){(t=e.target.result)?(++this._resultCount,t.continue()):this.onQueryFinished()}.bind(this),r.onerror=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this)}},t}return t}(e.BaseCount);e.NotWhere=t})((t=e.Business||(e.Business={})).Count||(t.Count={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.executeInLogic=function(e,t){var r,n,s=this._objectStore.index(e),i=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this);if(this._checkFlag)for(var o=0,u=t.length;o<u;o++)this._errorOccured||((n=s.openCursor(IDBKeyRange.only(t[o]))).onsuccess=function(e){(r=e.target.result)?(this._whereChecker.check(r.value)&&++this._resultCount,r.continue()):o+1===u&&this.onQueryFinished()}.bind(this),n.onerror=i);else if(this._objectStore.count)for(o=0,u=t.length;o<u;o++)this._errorOccured||((n=s.count(IDBKeyRange.only(t[o]))).onsuccess=function(e){this._resultCount+=e.target.result,o+1===u&&this.onQueryFinished()}.bind(this),n.onerror=i);else for(o=0,u=t.length;o<u;o++)this._errorOccured||((n=s.openCursor(IDBKeyRange.only(t[o]))).onsuccess=function(e){(r=e.target.result)?(++this._resultCount,r.continue()):o+1===u&&this.onQueryFinished()}.bind(this),n.onerror=i)},t}return t}(e.NotWhere);e.In=t})((t=e.Business||(e.Business={})).Count||(t.Count={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.executeLikeLogic=function(e,t,r){var n;this._compValue=t.toLowerCase(),this._compValueLength=this._compValue.length,this._compSymbol=r;var s=this._objectStore.index(e).openCursor();s.onerror=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this),this._checkFlag?s.onsuccess=function(e){(n=e.target.result)?(this.filterOnOccurence(n.key)&&this._whereChecker.check(n.value)&&++this._resultCount,n.continue()):this.onQueryFinished()}.bind(this):s.onsuccess=function(e){(n=e.target.result)?(this.filterOnOccurence(n.key)&&++this._resultCount,n.continue()):this.onQueryFinished()}.bind(this)},t}return t}(e.In);e.Like=t})((t=e.Business||(e.Business={})).Count||(t.Count={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.executeWhereLogic=function(e,t,r){t=r?t[r]:t;var n,s;this._checkFlag?(n=this._objectStore.index(e).openCursor(this.getKeyRange(t,r))).onsuccess=function(e){(s=e.target.result)?(this._whereChecker.check(s.value)&&++this._resultCount,s.continue()):this.onQueryFinished()}.bind(this):this._objectStore.count?(n=this._objectStore.index(e).count(this.getKeyRange(t,r))).onsuccess=function(){this._resultCount=n.result,this.onQueryFinished()}.bind(this):(n=this._objectStore.index(e).openCursor(this.getKeyRange(t,r))).onsuccess=function(e){(s=e.target.result)?(++this._resultCount,s.continue()):this.onQueryFinished()}.bind(this),n.onerror=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this)},t}return t}(e.Like);e.Where=t})((t=e.Business||(e.Business={})).Count||(t.Count={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(r){var n=function(r){__extends(n,r);function n(e,t,n){var s=r.call(this)||this;return s._onError=n,s._onSuccess=t,s._query=e,s}return n.prototype.execute=function(){if(this.isTableExist(this._query.From))try{void 0!==this._query.Where?this._query.Where.Or||Array.isArray(this._query.Where)?new t.Select.Instance(this._query,function(e){this._resultCount=e.length,this.onTransactionCompleted()}.bind(this),this._onError).execute():(this.initTransaction(),this.goToWhereLogic()):(this.initTransaction(),this.executeWhereUndefinedLogic())}catch(e){this.onExceptionOccured(e,{TableName:this._query.From})}else this._errorOccured=!0,this.onErrorOccured(new e.Error(e.Error_Type.TableNotExist,{TableName:this._query.From}).get(),!0)},n.prototype.initTransaction=function(){t.createTransaction([this._query.From],this.onTransactionCompleted.bind(this),"readonly"),this._objectStore=t.db_transaction.objectStore(this._query.From)},n.prototype.onQueryFinished=function(){!0===this._isTransaction&&this.onTransactionCompleted()},n.prototype.onTransactionCompleted=function(){!1===this._errorOccured&&this._onSuccess(this._resultCount)},n}(r.Where);r.Instance=n})((t=e.Business||(e.Business={})).Count||(t.Count={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){!function(e){(e.Update||(e.Update={})).updateValue=function(e,t){for(var r in e)if("object"!=typeof e[r])t[r]=e[r];else for(var n in e[r]){switch(n){case"+":t[r]+=e[r][n];break;case"-":t[r]-=e[r][n];break;case"*":t[r]*=e[r][n];break;case"/":t[r]/=e[r][n];break;default:t[r]=e[r]}break}return t};var t=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._checkFlag=!1,t.onQueryFinished=function(){!0===this._isTransaction&&this.onTransactionCompleted()},t}return t}(e.Base);e.BaseUpdate=t}(e.Business||(e.Business={}))}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var r=function(t){__extends(r,t);function r(){var r=null!==t&&t.apply(this,arguments)||this;return r.executeWhereUndefinedLogic=function(){var t,r=this._objectStore.openCursor();r.onsuccess=function(r){(t=r.target.result)?(t.update(e.updateValue(this._query.Set,t.value)),++this._rowAffected,t.continue()):this.onQueryFinished()}.bind(this),r.onerror=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this)},r}return r}(t.BaseUpdate);e.NotWhere=r})((t=e.Business||(e.Business={})).Update||(t.Update={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(t){__extends(r,t);function r(){var r=null!==t&&t.apply(this,arguments)||this;return r.executeInLogic=function(t,r){var n,s,i=this._objectStore.index(t),o=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this);if(this._checkFlag)for(var u=0,c=r.length;u<c;u++)this._errorOccured||((s=i.openCursor(IDBKeyRange.only(r[u]))).onsuccess=function(t){(n=t.target.result)?(this._whereChecker.check(n.value)&&(n.update(e.updateValue(this._query.Set,n.value)),++this._rowAffected),n.continue()):u+1===c&&this.onQueryFinished()}.bind(this),s.onerror=o);else for(u=0,c=r.length;u<c;u++)this._errorOccured||((s=i.openCursor(IDBKeyRange.only(r[u]))).onsuccess=function(t){(n=t.target.result)?(n.update(e.updateValue(this._query.Set,n.value)),++this._rowAffected,n.continue()):u+1===c&&this.onQueryFinished()}.bind(this),s.onerror=o)},r}return r}(e.NotWhere);e.In=t})((t=e.Business||(e.Business={})).Update||(t.Update={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(t){__extends(r,t);function r(){var r=null!==t&&t.apply(this,arguments)||this;return r.executeLikeLogic=function(t,r,n){var s;this._compValue=r.toLowerCase(),this._compValueLength=this._compValue.length,this._compSymbol=n;var i=this._objectStore.index(t).openCursor();i.onerror=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this),this._checkFlag?i.onsuccess=function(t){(s=t.target.result)?(this.filterOnOccurence(s.key)&&this._whereChecker.check(s.value)&&(s.update(e.updateValue(this._query.Set,s.value)),++this._rowAffected),s.continue()):this.onQueryFinished()}.bind(this):i.onsuccess=function(t){(s=t.target.result)?(this.filterOnOccurence(s.key)&&(s.update(e.updateValue(this._query.Set,s.value)),++this._rowAffected),s.continue()):this.onQueryFinished()}.bind(this)},r}return r}(e.In);e.Like=t})((t=e.Business||(e.Business={})).Update||(t.Update={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(t){__extends(r,t);function r(){var r=null!==t&&t.apply(this,arguments)||this;return r.executeWhereLogic=function(t,r,n){var s,i;r=n?r[n]:r,i=this._objectStore.index(t).openCursor(this.getKeyRange(r,n)),this._checkFlag?i.onsuccess=function(t){(s=t.target.result)?(this._whereChecker.check(s.value)&&(s.update(e.updateValue(this._query.Set,s.value)),++this._rowAffected),s.continue()):this.onQueryFinished()}.bind(this):i.onsuccess=function(t){(s=t.target.result)?(s.update(e.updateValue(this._query.Set,s.value)),++this._rowAffected,s.continue()):this.onQueryFinished()}.bind(this),i.onerror=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this)},r}return r}(e.Like);e.Where=t})((t=e.Business||(e.Business={})).Update||(t.Update={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var r=function(r){__extends(n,r);function n(e,t,n){var s=r.call(this)||this;return s._onSuccess=t,s._onError=n,s._query=e,s}return n.prototype.execute=function(){try{this._error=new e.SchemaChecker(this.getTable(this._query.In)).check(this._query.Set,this._query.In),this._error?(this._errorOccured=!0,this.onErrorOccured(this._error,!0)):this._query.Where?this._query.Where.Or||Array.isArray(this._query.Where)?this.executeComplexLogic():(this.initTransaction(),this.goToWhereLogic()):(this.initTransaction(),this.executeWhereUndefinedLogic())}catch(e){this._errorOccured=!0,this.onExceptionOccured.call(this,e,{TableName:this._query.In})}},n.prototype.onTransactionCompleted=function(){!1===this._errorOccured&&this._onSuccess(this._rowAffected)},n.prototype.initTransaction=function(){t.createTransaction([this._query.In],this.onTransactionCompleted.bind(this)),this._objectStore=t.db_transaction.objectStore(this._query.In)},n.prototype.executeComplexLogic=function(){new t.Select.Instance({From:this._query.In,Where:this._query.Where},function(e){var t=this.getPrimaryKey(this._query.In),r=[],n={};e.forEach(function(e){r.push(e[t])}),e=null,n[t]={In:r},this._query.Where=n,this.initTransaction(),this.goToWhereLogic()}.bind(this),this._onError.bind(this)).execute()},n}(e.Where);e.Instance=r})((t=e.Business||(e.Business={})).Update||(t.Update={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(t){var r=function(){function t(e){this._table=e}return t.prototype.check=function(t,r){var n=null;return"object"==typeof t?this._table?this._table._columns.every(function(e){return null===n&&(e._name in t&&(n=this.checkByColumn(e,t[e._name])),!0)},this):n=new e.Error(e.Error_Type.TableNotExist,{TableName:r}).get():n=new e.Error(e.Error_Type.NotObject).get(),n},t.prototype.checkByColumn=function(t,r){var n=null;t._notNull&&e.isNull(r)&&(n=new e.Error(e.Error_Type.NullValue,{ColumnName:t._name}).get());var s=e.getType(r);if(t._dataType&&s!==t._dataType&&"object"!==s&&(n=new e.Error(e.Error_Type.BadDataType,{ColumnName:t._name}).get()),"object"===s){var i=["+","-","*","/"];for(var o in r){i.indexOf(o)<0&&t._dataType&&s!==t._dataType&&(n=new e.Error(e.Error_Type.BadDataType,{ColumnName:t._name}).get());break}}return n},t}();t.SchemaChecker=r})((t=e.Business||(e.Business={})).Update||(t.Update={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var r=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._checkFlag=!1,t}return t}(t.Base);e.BaseRemove=r})((t=e.Business||(e.Business={})).Remove||(t.Remove={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.executeWhereUndefinedLogic=function(){var e,t=this._objectStore.openCursor();t.onsuccess=function(t){(e=t.target.result)?(e.delete(),++this._rowAffected,e.continue()):this.onQueryFinished()}.bind(this),t.onerror=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this)},t}return t}(e.BaseRemove);e.NotWhere=t})((t=e.Business||(e.Business={})).Remove||(t.Remove={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.executeInLogic=function(e,t){var r,n,s=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this);if(this._checkFlag)for(var i=0,o=t.length;i<o;i++)this._errorOccured||((n=this._objectStore.index(e).openCursor(IDBKeyRange.only(t[i]))).onsuccess=function(e){(r=e.target.result)?(this._whereChecker.check(r.value)&&(r.delete(),++this._rowAffected),r.continue()):i+1===o&&this.onQueryFinished()}.bind(this),n.onerror=s);else for(i=0,o=t.length;i<o;i++)this._errorOccured||((n=this._objectStore.index(e).openCursor(IDBKeyRange.only(t[i]))).onsuccess=function(e){(r=e.target.result)?(r.delete(),++this._rowAffected,r.continue()):i+1===o&&this.onQueryFinished()}.bind(this),n.onerror=s)},t}return t}(e.NotWhere);e.In=t})((t=e.Business||(e.Business={})).Remove||(t.Remove={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.executeLikeLogic=function(e,t,r){var n;this._compValue=t.toLowerCase(),this._compValueLength=this._compValue.length,this._compSymbol=r,this.cursor_request=this._objectStore.index(e).openCursor(),this.cursor_request.onerror=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this),this._checkFlag?this.cursor_request.onsuccess=function(e){(n=e.target.result)?(this.filterOnOccurence(n.key)&&this._whereChecker.check(n.value)&&(n.delete(),++this._rowAffected),n.continue()):this.onQueryFinished()}.bind(this):this.cursor_request.onsuccess=function(e){(n=e.target.result)?(this.filterOnOccurence(n.key)&&(n.delete(),++this._rowAffected),n.continue()):this.onQueryFinished()}.bind(this)},t}return t}(e.In);e.Like=t})((t=e.Business||(e.Business={})).Remove||(t.Remove={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var t=function(e){__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.executeWhereLogic=function(e,t,r){var n,s;t=r?t[r]:t,s=this._objectStore.index(e).openCursor(this.getKeyRange(t,r)),this._checkFlag?s.onsuccess=function(e){(n=e.target.result)?(this._whereChecker.check(n.value)&&(n.delete(),++this._rowAffected),n.continue()):this.onQueryFinished()}.bind(this):s.onsuccess=function(e){(n=e.target.result)?(n.delete(),++this._rowAffected,n.continue()):this.onQueryFinished()}.bind(this),s.onerror=function(e){this._errorOccured=!0,this.onErrorOccured(e)}.bind(this)},t}return t}(e.Like);e.Where=t})((t=e.Business||(e.Business={})).Remove||(t.Remove={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(r){var n=function(r){__extends(n,r);function n(e,t,n){var s=r.call(this)||this;return s._query=e,s._onSuccess=t,s._onError=n,s}return n.prototype.execute=function(){try{this.initTransaction(),this._query.Where?Array.isArray(this._query.Where)?this.processWhereArrayQry():this.processWhere():this.executeWhereUndefinedLogic()}catch(e){this._errorOccured=!0,this.onExceptionOccured(e,{TableName:this._query.From})}},n.prototype.processWhereArrayQry=function(){new t.Select.Instance(this._query,function(e){var t=[],r=this.getPrimaryKey(this._query.From);e.forEach(function(e){t.push(e[r])}),e=null,this._query.Where={},this._query.Where[r]={In:t},this.processWhere(!1)}.bind(this),this._onError).execute()},n.prototype.processWhere=function(){this._query.Where.Or&&this.processOrLogic(),this.goToWhereLogic()},n.prototype.initTransaction=function(){t.createTransaction([this._query.From],this.onTransactionCompleted.bind(this)),this._objectStore=t.db_transaction.objectStore(this._query.From)},n.prototype.onTransactionCompleted=function(){!1===this._errorOccured&&this._onSuccess(this._rowAffected)},n.prototype.onQueryFinished=function(){!0===this._isOr?this.orQuerySuccess():!0===this._isTransaction&&this.onTransactionCompleted()},n.prototype.orQuerySuccess=function(){var t=e.getObjectFirstKey(this._orInfo.OrQuery);if(null!=t){var r={};r[t]=this._orInfo.OrQuery[t],delete this._orInfo.OrQuery[t],this._query.Where=r,this.goToWhereLogic()}else this._isOr=!0},n.prototype.processOrLogic=function(){this._isOr=!0,this._orInfo={OrQuery:this._query.Where.Or},delete this._query.Where.Or},n}(r.Where);r.Instance=n})((t=e.Business||(e.Business={})).Remove||(t.Remove={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(r){var n=function(n){__extends(s,n);function s(e,t,r){var s=n.call(this)||this;return s._valuesAffected=[],s._onError=r,s._query=e,s._onSuccess=t,s._tableName=s._query.Into,s}return s.prototype.execute=function(){var t=this.getTable(this._tableName);if(Array.isArray(this._query.Values))if(t)try{if(this._query.SkipDataCheck)this.insertData(this._query.Values);else{var n=new r.ValuesChecker(t,this._query.Values);n.checkAndModifyValues(function(e){e?this.onErrorOccured(n._error,!0):this.insertData(n._values),n=void 0}.bind(this))}this._query.Values=void 0}catch(e){this.onExceptionOccured(e,{TableName:this._tableName})}else new e.Error(e.Error_Type.TableNotExist,{TableName:this._tableName}).throw();else this.onErrorOccured(new e.Error(e.Error_Type.NotArray).get(),!0)},s.prototype.onTransactionCompleted=function(){!1===this._errorOccured&&this._onSuccess(this._query.Return?this._valuesAffected:this._rowAffected)},s.prototype.onQueryFinished=function(){!0===this._isTransaction&&this.onTransactionCompleted()},s.prototype.insertData=function(e){var r,n=0;r=this._query.Return?function(t){if(t){var i=s.add(t);i.onerror=this.onErrorOccured.bind(this),i.onsuccess=function(s){this._valuesAffected.push(t),r.call(this,e[n++])}.bind(this)}else this.onQueryFinished()}:function(t){if(t){var i=s.add(t);i.onerror=this.onErrorOccured.bind(this),i.onsuccess=function(t){++this._rowAffected,r.call(this,e[n++])}.bind(this)}else this.onQueryFinished()},t.createTransaction([this._query.Into],this.onTransactionCompleted.bind(this));var s=t.db_transaction.objectStore(this._query.Into);r.call(this,e[n++])},s}(t.Base);r.Instance=n})((t=e.Business||(e.Business={})).Insert||(t.Insert={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(t){var r=function(){function t(e,t){this._errorOccured=!1,this._autoIncrementValue={},this._table=e,this._autoIncrementValue=t}return t.prototype.checkAndModifyValue=function(e){return this._value=e,this._table._columns.every(function(t){return this.checkAndModifyColumnValue(t,e),!this._errorOccured},this),this._errorOccured},t.prototype.checkNotNullAndDataType=function(t){t._notNull&&e.isNull(this._value[t._name])?this.onValidationError(e.Error_Type.NullValue,{ColumnName:t._name}):t._dataType&&!e.isNull(this._value[t._name])&&e.getType(this._value[t._name])!==t._dataType&&this.onValidationError(e.Error_Type.BadDataType,{ColumnName:t._name})},t.prototype.checkAndModifyColumnValue=function(t){t._autoIncrement?this._value[t._name]=++this._autoIncrementValue[t._name]:t._default&&e.isNull(this._value[t._name])&&(this._value[t._name]=t._default),this.checkNotNullAndDataType(t)},t.prototype.onValidationError=function(t,r){this._errorOccured=!0,this._error=new e.Error(t,r).get()},t}();t.ValueChecker=r})((t=e.Business||(e.Business={})).Insert||(t.Insert={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){(function(e){var r=function(){function r(e,t){this._table=e,this._values=t}return r.prototype.checkAndModifyValues=function(r){this._onFinish=r;var n={};this._table._columns.filter(function(e){return e._autoIncrement}).forEach(function(e){var r="JsStore_"+t.active_db._name+"_"+this._table._name+"_"+e._name+"_Value";KeyStore.get(r,function(t){n[e._name]=t})},this),KeyStore.get("dumy_key",function(t){this._valueCheckerObj=new e.ValueChecker(this._table,n),this.startChecking()}.bind(this),function(e){this._error=e,this._onFinish(!0)}.bind(this))},r.prototype.startChecking=function(){var e=!1;if(this._values.every(function(t){return!(e=this._valueCheckerObj.checkAndModifyValue(t))},this),e)this._error=this._valueCheckerObj._error,this._onFinish(!0);else{for(var r in this._valueCheckerObj._autoIncrementValue){var n="JsStore_"+t.active_db._name+"_"+this._table._name+"_"+r+"_Value";KeyStore.set(n,this._valueCheckerObj._autoIncrementValue[r])}KeyStore.get("dumy_key",function(e){this._onFinish(!1)}.bind(this),function(e){this._error=e,this._onFinish(!0)}.bind(this))}},r}();e.ValuesChecker=r})((t=e.Business||(e.Business={})).Insert||(t.Insert={}));var t}(JsStore||(JsStore={}));var JsStore;!function(e){e.worker_status=e.WebWorker_Status.NotStarted;var t=function(){function t(){this._requestQueue=[],this._isCodeExecuting=!1}return t.prototype.pushApi=function(e,t){return!0===t?new Promise(function(t,r){e.OnSuccess=function(e){t(e)},e.OnError=function(e){r(e)},this.prcoessExecutionOfCode(e)}.bind(this)):(this.prcoessExecutionOfCode(e),this)},t.prototype.createWorker=function(){try{if(Worker){var t=this.getScriptUrl(e.file_name);t&&t.length>0?(e.worker_instance=new Worker(t),e.worker_instance.onmessage=function(e){this.onMessageFromWorker(e)}.bind(this),this.executeCodeUsingWorker({Name:"change_log_status",Query:{logging:e.enable_log}}),setTimeout(function(){e.worker_status!==e.WebWorker_Status.Failed&&(e.worker_status=e.WebWorker_Status.Registered),e.status.ConStatus===e.Connection_Status.Connected&&this.executeCode()}.bind(this),100)):this.onWorkerFailed()}else this.onWorkerFailed()}catch(e){this.onWorkerFailed()}},t.prototype.prcoessExecutionOfCode=function(t){if(e.status.ConStatus===e.Connection_Status.NotStarted)switch(t.Name){case"create_db":case"open_db":this._requestQueue.splice(0,0,t),e.worker_status!==e.WebWorker_Status.NotStarted&&this.executeCode(),e.status.ConStatus=e.Connection_Status.Connected;break;default:this._requestQueue.push(t)}else this._requestQueue.push(t),1===this._requestQueue.length&&e.worker_status!==e.WebWorker_Status.NotStarted&&this.executeCode();e.log("request pushed: "+t.Name)},t.prototype.executeCode=function(){if(!this._isCodeExecuting&&this._requestQueue.length>0){this._isCodeExecuting=!0;var t=this._requestQueue[0],r={Name:t.Name,Query:t.Query};e.log("request executing : "+t.Name),e.worker_status===e.WebWorker_Status.Registered?this.executeCodeUsingWorker(r):this.executeCodeDirect(r)}},t.prototype.executeCodeDirect=function(t){new e.Business.Main(function(e){this.processFinishedRequest(e)}.bind(this)).checkConnectionAndExecuteLogic(t)},t.prototype.executeCodeUsingWorker=function(t){e.worker_instance.postMessage(t)},t.prototype.processFinishedRequest=function(t){var r=this._requestQueue.shift();this._isCodeExecuting=!1,r&&(e.log("request finished : "+r.Name),t.ErrorOccured?r.OnError&&r.OnError(t.ErrorDetails):r.OnSuccess&&r.OnSuccess(t.ReturnedValue),this.executeCode())},t.prototype.onWorkerFailed=function(){console.warn("JsStore is not runing in web worker"),e.worker_status=e.WebWorker_Status.Failed,e.status.ConStatus===e.Connection_Status.NotStarted&&this.executeCode()},t.prototype.getScriptUrl=function(e){for(var t="",r=e?e.toLowerCase():"jsstore",n=document.getElementsByTagName("script"),s=n.length-1,i="";s>=0;s--)if((i=(i=n[s].src).substring(i.lastIndexOf("/")+1).toLowerCase()).length>0&&i.indexOf(r)>=0)return t=n[s].src;return t},t.prototype.onMessageFromWorker=function(e){if("string"==typeof e.data){switch(e.data.split(":")[1]){case"WorkerFailed":this.onWorkerFailed()}}else this.processFinishedRequest(e.data)},t}();e.CodeExecutionHelper=t}(JsStore||(JsStore={}));var Model=JsStore.Model,DataBase=Model.DataBase,Column=Model.Column,Table=Model.Table,JsStore;!function(e){var t=function(t){__extends(r,t);function r(r){void 0===r&&(r=null);var n=t.call(this)||this;return e.worker_status===e.WebWorker_Status.Registered?e.worker_instance.terminate():e.worker_status===e.WebWorker_Status.NotStarted&&KeyStore.init(),n.createWorker(),r&&n.openDb(r,null,null),n}return r.prototype.openDb=function(e,t,r){return this.pushApi({Name:"open_db",Query:e,OnSuccess:t,OnError:r},!1)},r.prototype.createDb=function(e,t,r){return this.pushApi({Name:"create_db",OnSuccess:t,OnError:r,Query:e},!1)},r.prototype.dropDb=function(e,t){var r=!e;return this.pushApi({Name:"drop_db",Query:null,OnSuccess:e,OnError:t},r)},r.prototype.select=function(e,t,r){t=e.OnSuccess?e.OnSuccess:t,r=e.OnError?e.OnError:r,e.OnSuccess=e.OnError=null;var n=!t;return this.pushApi({Name:"select",Query:e,OnSuccess:t,OnError:r},n)},r.prototype.transaction=function(e,t,r){t=e.OnSuccess?e.OnSuccess:t,r=e.OnError?e.OnError:r,e.OnSuccess=e.OnError=null;var n=!t;return e.Logic=e.Logic.toString(),this.pushApi({Name:"transaction",Query:e,OnSuccess:t,OnError:r},n)},r.prototype.count=function(e,t,r){t=e.OnSuccess?e.OnSuccess:t,r=e.OnError?e.OnError:r,e.OnSuccess=e.OnError=null;var n=!t;return this.pushApi({Name:"count",Query:e,OnSuccess:t,OnError:r},n)},r.prototype.insert=function(e,t,r){t=e.OnSuccess?e.OnSuccess:t,r=e.OnError?e.OnError:r,e.OnSuccess=e.OnError=null;var n=!t;return this.pushApi({Name:"insert",Query:e,OnSuccess:t,OnError:r},n)},r.prototype.update=function(e,t,r){t=e.OnSuccess?e.OnSuccess:t,r=e.OnError?e.OnError:r,e.OnSuccess=e.OnError=null;var n=!t;return this.pushApi({Name:"update",Query:e,OnSuccess:t,OnError:r},n)},r.prototype.delete=function(t,r,n){e.logError("delete is deprecated because delete is reserved keyword in js. Please use remove api.")},r.prototype.remove=function(e,t,r){t=e.OnSuccess?e.OnSuccess:t,r=e.OnError?e.OnError:r,e.OnSuccess=e.OnError=null;var n=!t;return this.pushApi({Name:"remove",Query:e,OnSuccess:t,OnError:r},n)},r.prototype.clear=function(e,t,r){var n=!t;return this.pushApi({Name:"clear",Query:e,OnSuccess:t,OnError:r},n)},r.prototype.bulkInsert=function(e,t,r){t=e.OnSuccess?e.OnSuccess:t,r=e.OnError?e.OnError:r;var n=!t;return e.OnSuccess=e.OnError=null,this.pushApi({Name:"bulk_insert",Query:e,OnSuccess:t,OnError:r},n)},r.prototype.exportJson=function(e){var t=function(t){var r=document.createElement("a");r.href=t,r.download=e.From+".json",r.click(),n&&n(null)},r=e.OnError,n=e.OnSuccess;e.OnSuccess=e.OnError=void 0;var s=!n;if(s)return new Promise(function(n,i){this.pushApi({Name:"export_json",Query:e,OnSuccess:t,OnError:r},s).then(function(e){t(e),n()}).catch(function(e){i(e)})});this.pushApi({Name:"export_json",Query:e,OnSuccess:t,OnError:r},s)},r}(e.CodeExecutionHelper);e.Instance=t}(JsStore||(JsStore={})),self&&!self.alert&&(self.onmessage=function(e){JsStore.log("Request executing from WebWorker, request name: "+e.data.Name);var t=e.data;(new JsStore.Business.Main).checkConnectionAndExecuteLogic(t)},JsStore.worker_status=JsStore.WebWorker_Status.Registered,KeyStore.init());